import api.gigachat_api

class GeneratePrompt:
    async def generate_post_prompt( user_text: str, style: str, nko_information: str) -> str:
        # Базовый промпт с учетом стиля и НКО
        base_context = f"Стиль изложения: {style}."
        if nko_information and nko_information != "None":
            base_context += f" Учитывай контекст некоммерческой организации: {nko_information}"
        content_type_instructions = """
Создай качественный пост для социальных сетей со следующей структурой:
- Основной текст с полезной информацией
- Призыв к действию или вопрос для вовлечения аудитории
- 3-5 релевантных хэштегов в конце
Требования:
- Текст должен быть живым и engaging
- Используй эмодзи где это уместно
- Абзацы не более 2-3 строк
- общий текст не более 200 слов
- Хэштеги должны быть релевантными тематике
- чем это полезно городу и людям
"""
        result = f"""
{base_context}
    
{content_type_instructions}
    
Запрос пользователя: {user_text}
    
Дополнительные требования:
- Отвечай на русском языке
- Используй структурированный подход
"""    
        return result
    async def generate_copy_of_post_prompt( user_text: str, style: str, nko_information: str) -> str:
        # Базовый промпт с учетом стиля и НКО
        base_context = f"Стиль изложения: {style}."
        if nko_information and nko_information != "None":
            base_context += f" Учитывай контекст некоммерческой организации: {nko_information}"
        content_type_instructions = """
Ты — профессиональный редактор. Твоя задача — создать ревизию текста, которая точечно интегрирует правки пользователя, являясь его полным аналогом по структуре, объему и стилистике.
Ты получишь запрос в одной строке. Сначала в этой строке будет идти исходный текст. Твоя задача - воспроизвести исходный текст, точечно внеся в него все указанные в примечаниях изменения. Сохраняй структуру, стиль и тон оригинала. Не добавляй пояснений, просто выведи исправленную версию.
""" 
        result = f"""
{base_context}
    
{content_type_instructions}
    
Запрос пользователя: {user_text}
    
Дополнительные требования:
- Отвечай на русском языке
- Будь конкретным и практичным
- Используй структурированный подход
- Предлагай реализуемые решения
- количество слов должно быть близким к оригиналу
"""
        return result
    async def generate_idea_prompt( user_text: str, style: str, nko_information: str) -> str:
        # Базовый промпт с учетом стиля и НКО
        base_context = f"Стиль изложения: {style}."
        if nko_information and nko_information != "None":
            base_context += f" Учитывай контекст некоммерческой организации: {nko_information}"
        if any(word in user_text.lower() for word in ['визуал', 'изображен', 'картинк', 'фото', 'граф','оформл']):
            content_type_instructions = """
            Предложи 5-7 креативных идей для визуального контента:
            - Опиши концепцию каждой идеи
            - Укажите возможные стили и цветовые палитры
            - Предложи варианты композиции
            - Добавь рекомендации по реализации
        
            Требования:
            - Идеи должны быть разнообразными и практичными
            - Учитывай современные тренды в дизайне
            - Ориентируйся на целевую аудиторию
            """
        else:
            content_type_instructions = """
            Предложи 7-10 креативных идей по запросу пользователя:
            - Детально опиши каждую идею
            - Укажите возможные форматы реализации
            - Добавь рекомендации по развитию идеи
            - Предложи варианты адаптации под разные каналы
        
            Требования:
            - Идеи должны быть конкретными и реализуемыми
            - Учитывай ресурсы некоммерческой организации
            - Ориентируйся на практическую пользу
            """
        result = f"""
{base_context}
    
{content_type_instructions}
    
Запрос пользователя: {user_text}
    
Дополнительные требования:
- Отвечай на русском языке
- Будь конкретным и практичным
- Используй структурированный подход
- количество слов не более 350
"""    
        return result
    async def generate_content_plan_prompt( user_text: str, nko_information: str) -> str:
        # Базовый промпт с учетом стиля и НКО
        base_context = ""
        if nko_information and nko_information != "None":
            base_context += f" Учитывай контекст некоммерческой организации: {nko_information}"
        content_type_instructions = """
Составь подробный контент-план со следующей структурой:
- Общая концепция и цели контента
- Темы для 7-14 публикаций с описанием
- Рекомендации по форматам (текст, фото, видео и т.д.)
- Предложения по времени публикации
- Метрики для оценки эффективности
        
Требования:
- План должен быть практичным и реализуемым
- Учитывай сезонность и актуальные тренды
- Включи разнообразие форматов
- не используй маркировки таблиц. пиши все обычным текстом.
"""        
        result = f"""
{base_context}
    
{content_type_instructions}
    
Запрос пользователя: {user_text}
    
Дополнительные требования:
- Отвечай на русском языке
- Будь конкретным и практичным
- Используй структурированный подход
- количество слов не более 350
"""    
        return result
    
    async def generate_edit_text_prompt( user_text: str, nko_information: str) -> str:
        PROMPT_TEMPLATE = f"""Ты — профессиональный редактор и ассистент для обработки текста. Пользователь отправит тебе сообщение, которое содержит ДВА элемента без какого-либо разделения:
        1. ЗАДАНИЕ - что нужно сделать с текстом
        2. ТЕКСТ - сам текст для обработки

        Твоя задача:
        1. Четко определить, где заканчивается задание и начинается текст
        2. Выполнить указанное задание над текстом
        3. Вернуть ТОЛЬКО результат обработки, без пояснений

        Примеры распознавания:
        - "исправь ошибки привет как дела" → задание: "исправь ошибки", текст: "привет как дела"
        - "сделай короче сегодня был прекрасный день" → задание: "сделай короче", текст: "сегодня был прекрасный день"
        - "перефразируй я хочу купить машину" → задание: "перефразируй", текст: "я хочу купить машину"

        Алгоритм:
        1. Найди в начале сообщения глагол-команду (исправь, перепиши, сократи, улучши и т.д.)
        2. Определи границу между инструкцией и текстом
        3. Выполни задание максимально качественно
        4. Верни готовый текст
        Учитывай контекст НКО: {nko_information}
        Сообщение пользователя: {user_text}

        Результат (ТОЛЬКО обработанный текст):"""

        return PROMPT_TEMPLATE